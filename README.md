
# Cronspell Python Package / CLI Tool
***Chronometry Spelled Out***


[![Github Pages][Github Pages]][Github Pages Link]


|          |                                                                                                                                                                                                                                   |
| -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Details  | [![Tests][Tests-image]][Tests-link] [![License - MIT][MIT-image]][MIT-link]                                                                                                                                                       |
| Features | [![linting - Ruff][ruff-image]][ruff-link] [![types - mypy][mypy-image]][mypy-link] [![test - pytest][pytest-image]][pytest-link]  [![Pre-Commit][precommit-image]][precommit-link] [![docs - mkdocs][mkdocs-image]][mkdocs-link] |

Date-expression domain specific language (DSL) parsing. A neat way to express things like "First Saturday of any year", or "3rd thursdays each month" and such.


## Status

CronSpell is currently in Beta. While it is considered well tested and stable for most use cases, there may still be some edge cases and bugs that need to be addressed. The maintainer encourages users to try it out and [provide feedback to help improving the library.](https://github.com/iilei/cronspell/issues)

Your contributions and bug reports are highly appreciated.

## Features

Cronspell is heavily inspired by Grafana's relative Date picker user interface. It was designed for the cases when configuration is needed to reflect irregular date-distances.

It offers a domain specific language to express relative dates and schedules. This way, any kind of date relation that humans easily understand can be conveyed.

### Python Usage

Installation:

```shell
pip install cronspell
```

Import:

```python
from cronspell import Cronspell, parse
```

### Cli Usage

Installation:

```shell
pip install 'cronspell[cli]'
```

List available commands:

```shell
cronspell --help
```

## Syntax Specification

Cronspell works by iteratively processing a given String, which serves as the *model*.

Based on the starting point `Anchor=now[UTC]`{:.yml} zero or more subsequent date math directives `0..*{DateMath}`{:.yml} affect the outcome.

The most simple although pointles example of a valid model is a zero-withd string due tho these permissive constraints.


<details>
  <summary>Parser Internals &mdash; <i>click to toggle visibility</i></summary>

<!-- start autogenerated: cronspell -->


<!-- end autogenerated: cronspell -->

</details>

<!-- start autogenerated: legend -->
<table>
 <caption>
  Legend
 </caption>
 <tr>
  <td scope="col">

$f$

  </td>
  <td scope="col">
   Pattern
  </td>
  <td scope="col">
   Example
  </td>
  <td scope="col">
   Alternative Example
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Now
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">now</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">now[Europe/Berlin]</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td colspan="4">
  </td>
 </tr>
 <tr>
  <td>
   <em>
    CalendarWeekModulo
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="p p-Indicator">[</span><span class="err">%</span><span class="p p-Indicator">,</span><span class="err">@</span><span class="p p-Indicator">]</span><span class="l l-Scalar l-Scalar-Plain">\s*\b(CW|Cw|cw)</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="err">@</span><span class="l l-Scalar l-Scalar-Plain">cw</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="err">%</span><span class="l l-Scalar l-Scalar-Plain">CW</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    YearModulo
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="p p-Indicator">[</span><span class="err">%</span><span class="p p-Indicator">,</span><span class="err">@</span><span class="p p-Indicator">]</span><span class="l l-Scalar l-Scalar-Plain">\s*\b(Y|y)(ears?)?</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="err">@</span><span class="l l-Scalar l-Scalar-Plain">y</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="err">%</span><span class="l l-Scalar l-Scalar-Plain">Y</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    MonthModulo
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="p p-Indicator">[</span><span class="err">%</span><span class="p p-Indicator">,</span><span class="err">@</span><span class="p p-Indicator">]</span><span class="l l-Scalar l-Scalar-Plain">\s*\b([Mm])(onths?)?</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="err">@</span><span class="l l-Scalar l-Scalar-Plain">m</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="err">%</span><span class="l l-Scalar l-Scalar-Plain">M</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td colspan="4">
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Y
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">([Yy]ears?|Y\b)</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Year</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Y</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    m
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">(?!mon\b)([mM]onths?|m\b)</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Month</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">m</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    W
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b([wW]eeks?|W)\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Week</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">W</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    d
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">([dD]ays?|d\b)</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Day</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">day</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    M
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">([mM]inutes?|M\b|[mM]in\b)</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Minute</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">M</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    H
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">([hH]ours?|H\b|[Hh]rs)</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Hour</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">H</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    S
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">(?!sat$)([sS]econds?|S\b|[sS]ec\b)</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Second</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">S</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td colspan="4">
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Mon
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[mM]on(?:day)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Monday</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">mon</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Tue
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[tT]ue(?:sday)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Tuesday</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">tue</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Wed
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[wW]ed(?:nesday)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Wednesday</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">wed</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Thu
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[tT]hu(?:rsday)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Thursday</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">thu</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Fri
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[fF]ri(?:day)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Friday</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">fri</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Sat
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[sS]at(?:urday)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Saturday</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">sat</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Sun
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[sS]un(?:day)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">Sunday</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">sun</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td colspan="4">
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Jan
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[jJ]an(?:uary)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">January</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">jan</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Feb
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[fF]eb(?:ruary)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">February</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">feb</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Mar
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[mM]ar(?:ch)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">March</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">mar</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Apr
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[aA]pr(?:il)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">April</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">apr</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    May
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[mM]ay\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">May</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">may</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Jun
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[jJ]une?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">June</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">jun</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Jul
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[jJ]uly?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">July</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">jul</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Aug
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[aA]ug(?:ust)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">August</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">aug</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Sep
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[sS]ep(?:tember)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">September</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">sep</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Oct
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[oO]ct(?:ober)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">October</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">oct</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Nov
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[nN]ov(?:ember)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">November</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">nov</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Dec
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\b[dD]ec(?:ember)?\b</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">December</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">dec</span>
</pre>
   </div>
  </td>
 </tr>
 <tr>
  <td colspan="4">
  </td>
 </tr>
 <tr>
  <td>
   <em>
    Comment
   </em>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">\/\*(.|\n)*?\*\/|\/\/.*?$</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="cm">/* inline comment */</span>
</pre>
   </div>
  </td>
  <td>
   <div class="highlight">
    <pre><span></span><span class="l l-Scalar l-Scalar-Plain">// eol comment</span>
</pre>
   </div>
  </td>
 </tr>
</table>

<!-- end autogenerated: legend -->

## pre-commit hook

This package comes with a [pre-commit](https://pre-commit.com/) hook that allows for automated
preflight checks on `yaml` files serving as sources for cronspell expressions.

Put this in your `.pre-commit-config.yaml` and adjust according to your needs:

```yaml
repos:
  - repo: https://github.com/iilei/cronspell
    rev: c2b316f53c536e808353d2b30b97d1660c267d4b   # v0.4.1
    hooks:
      - id: cronspell
        files: .*\/cfg\.ya?ml$
        args: ["--yamlpath", "/*/*date*" ]

```


## Credits

* Domain-Specific-Language Parser: [TextX]
* This package was created with [The Hatchlor] project template.

[TextX]: https://textx.github.io/textX/
[The Hatchlor]: https://github.com/florianwilhelm/the-hatchlor



[Tests-image]: https://github.com/iilei/cronspell/actions/workflows/tests.yml/badge.svg?branch=master
[Tests-link]: https://github.com/iilei/cronspell/actions/workflows/tests.yml
[hatch-image]: https://img.shields.io/badge/%F0%9F%A5%9A-hatch-4051b5.svg
[hatch-link]: https://github.com/pypa/hatch
[ruff-image]: https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/ruff/main/assets/badge/v2.json
[ruff-link]: https://github.com/charliermarsh/ruff
[mypy-image]: https://img.shields.io/badge/Types-mypy-blue.svg
[mypy-link]: https://mypy-lang.org/
[pytest-image]: https://img.shields.io/static/v1?label=‎&message=Pytest&logo=Pytest&color=0A9EDC&logoColor=white
[pytest-link]:  https://docs.pytest.org/
[mkdocs-image]: https://img.shields.io/static/v1?label=‎&message=mkdocs&logo=Material+for+MkDocs&color=526CFE&logoColor=white
[mkdocs-link]: https://www.mkdocs.org/
[precommit-image]: https://img.shields.io/static/v1?label=‎&message=pre-commit&logo=pre-commit&color=76877c
[precommit-link]: https://pre-commit.com/
[MIT-image]: https://img.shields.io/badge/License-MIT-9400d3.svg
[MIT-link]: https://raw.githubusercontent.com/iilei/cronspell/refs/heads/master/LICENSE.txt
[Github Pages]: https://img.shields.io/badge/github%20pages-121013?style=for-the-badge&logo=github&logoColor=teal
[Github Pages Link]: https://iilei.github.io/cronspell/
